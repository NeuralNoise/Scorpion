{"filter":false,"title":"policy.h","tooltip":"/scorpion/vm/policy.h","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":59,"column":30},"end":{"row":59,"column":76},"action":"remove","lines":["gSvm.appmanager.controller.getPermissionSize()"],"id":749},{"start":{"row":59,"column":30},"end":{"row":59,"column":31},"action":"insert","lines":["p"]}],[{"start":{"row":59,"column":31},"end":{"row":59,"column":32},"action":"insert","lines":["s"],"id":750}],[{"start":{"row":59,"column":30},"end":{"row":59,"column":32},"action":"remove","lines":["ps"],"id":751},{"start":{"row":59,"column":30},"end":{"row":59,"column":35},"action":"insert","lines":["psize"]}],[{"start":{"row":60,"column":18},"end":{"row":60,"column":19},"action":"insert","lines":["p"],"id":752}],[{"start":{"row":60,"column":19},"end":{"row":60,"column":20},"action":"insert","lines":["o"],"id":753}],[{"start":{"row":60,"column":18},"end":{"row":60,"column":20},"action":"remove","lines":["po"],"id":754},{"start":{"row":60,"column":18},"end":{"row":60,"column":26},"action":"insert","lines":["policies"]}],[{"start":{"row":60,"column":26},"end":{"row":60,"column":28},"action":"insert","lines":["[]"],"id":755}],[{"start":{"row":60,"column":27},"end":{"row":60,"column":28},"action":"insert","lines":["i"],"id":756}],[{"start":{"row":60,"column":29},"end":{"row":60,"column":30},"action":"insert","lines":[" "],"id":757}],[{"start":{"row":60,"column":30},"end":{"row":60,"column":31},"action":"insert","lines":["="],"id":758}],[{"start":{"row":60,"column":31},"end":{"row":60,"column":32},"action":"insert","lines":["="],"id":759}],[{"start":{"row":60,"column":32},"end":{"row":60,"column":33},"action":"insert","lines":[" "],"id":760}],[{"start":{"row":60,"column":33},"end":{"row":60,"column":34},"action":"insert","lines":["p"],"id":761}],[{"start":{"row":60,"column":34},"end":{"row":60,"column":35},"action":"insert","lines":["o"],"id":762}],[{"start":{"row":60,"column":33},"end":{"row":60,"column":35},"action":"remove","lines":["po"],"id":763},{"start":{"row":60,"column":33},"end":{"row":60,"column":41},"action":"insert","lines":["policies"]}],[{"start":{"row":60,"column":40},"end":{"row":60,"column":41},"action":"remove","lines":["s"],"id":764}],[{"start":{"row":60,"column":39},"end":{"row":60,"column":40},"action":"remove","lines":["e"],"id":765}],[{"start":{"row":60,"column":38},"end":{"row":60,"column":39},"action":"remove","lines":["i"],"id":766}],[{"start":{"row":60,"column":37},"end":{"row":60,"column":38},"action":"remove","lines":["c"],"id":767}],[{"start":{"row":60,"column":37},"end":{"row":60,"column":38},"action":"insert","lines":["c"],"id":768}],[{"start":{"row":60,"column":38},"end":{"row":60,"column":39},"action":"insert","lines":["y"],"id":769}],[{"start":{"row":60,"column":40},"end":{"row":61,"column":0},"action":"insert","lines":["",""],"id":770},{"start":{"row":61,"column":0},"end":{"row":61,"column":15},"action":"insert","lines":["               "]}],[{"start":{"row":61,"column":15},"end":{"row":61,"column":16},"action":"insert","lines":[" "],"id":771}],[{"start":{"row":61,"column":16},"end":{"row":61,"column":17},"action":"insert","lines":[" "],"id":772}],[{"start":{"row":61,"column":17},"end":{"row":61,"column":18},"action":"insert","lines":[" "],"id":773}],[{"start":{"row":61,"column":18},"end":{"row":61,"column":19},"action":"insert","lines":[" "],"id":774}],[{"start":{"row":61,"column":19},"end":{"row":61,"column":20},"action":"insert","lines":["r"],"id":775}],[{"start":{"row":61,"column":20},"end":{"row":61,"column":21},"action":"insert","lines":["e"],"id":776}],[{"start":{"row":61,"column":21},"end":{"row":61,"column":22},"action":"insert","lines":["t"],"id":777}],[{"start":{"row":61,"column":22},"end":{"row":61,"column":23},"action":"insert","lines":["u"],"id":778}],[{"start":{"row":61,"column":23},"end":{"row":61,"column":24},"action":"insert","lines":["r"],"id":779}],[{"start":{"row":61,"column":24},"end":{"row":61,"column":25},"action":"insert","lines":["n"],"id":780}],[{"start":{"row":61,"column":25},"end":{"row":61,"column":26},"action":"insert","lines":[" "],"id":781}],[{"start":{"row":61,"column":26},"end":{"row":61,"column":27},"action":"insert","lines":["t"],"id":782}],[{"start":{"row":61,"column":27},"end":{"row":61,"column":28},"action":"insert","lines":["r"],"id":783}],[{"start":{"row":61,"column":28},"end":{"row":61,"column":29},"action":"insert","lines":["u"],"id":784}],[{"start":{"row":61,"column":29},"end":{"row":61,"column":30},"action":"insert","lines":["e"],"id":785}],[{"start":{"row":61,"column":30},"end":{"row":61,"column":31},"action":"insert","lines":[";"],"id":786}],[{"start":{"row":63,"column":18},"end":{"row":63,"column":33},"action":"remove","lines":["policyrequested"],"id":787},{"start":{"row":63,"column":18},"end":{"row":63,"column":19},"action":"insert","lines":["f"]}],[{"start":{"row":63,"column":19},"end":{"row":63,"column":20},"action":"insert","lines":["a"],"id":788}],[{"start":{"row":63,"column":20},"end":{"row":63,"column":21},"action":"insert","lines":["l"],"id":789}],[{"start":{"row":63,"column":21},"end":{"row":63,"column":22},"action":"insert","lines":["s"],"id":790}],[{"start":{"row":63,"column":22},"end":{"row":63,"column":23},"action":"insert","lines":["e"],"id":791}],[{"start":{"row":51,"column":14},"end":{"row":52,"column":25},"action":"remove","lines":["","    bool policyrequested;"],"id":792}],[{"start":{"row":56,"column":43},"end":{"row":57,"column":66},"action":"remove","lines":["","           psize = gSvm.appmanager.controller.getPermissionSize();"],"id":793}],[{"start":{"row":63,"column":28},"end":{"row":64,"column":66},"action":"insert","lines":["","           psize = gSvm.appmanager.controller.getPermissionSize();"],"id":795}],[{"start":{"row":65,"column":33},"end":{"row":65,"column":79},"action":"remove","lines":["gSvm.appmanager.controller.getPermissionSize()"],"id":796},{"start":{"row":65,"column":33},"end":{"row":65,"column":34},"action":"insert","lines":["p"]}],[{"start":{"row":65,"column":34},"end":{"row":65,"column":35},"action":"insert","lines":["s"],"id":797}],[{"start":{"row":65,"column":33},"end":{"row":65,"column":35},"action":"remove","lines":["ps"],"id":798},{"start":{"row":65,"column":33},"end":{"row":65,"column":38},"action":"insert","lines":["psize"]}],[{"start":{"row":75,"column":12},"end":{"row":76,"column":0},"action":"insert","lines":["",""],"id":799},{"start":{"row":76,"column":0},"end":{"row":76,"column":11},"action":"insert","lines":["           "]}],[{"start":{"row":76,"column":11},"end":{"row":77,"column":0},"action":"insert","lines":["",""],"id":800},{"start":{"row":77,"column":0},"end":{"row":77,"column":11},"action":"insert","lines":["           "]}],[{"start":{"row":77,"column":11},"end":{"row":77,"column":12},"action":"insert","lines":["p"],"id":801}],[{"start":{"row":77,"column":12},"end":{"row":77,"column":13},"action":"insert","lines":["o"],"id":802}],[{"start":{"row":77,"column":11},"end":{"row":77,"column":13},"action":"remove","lines":["po"],"id":803},{"start":{"row":77,"column":11},"end":{"row":77,"column":19},"action":"insert","lines":["policies"]}],[{"start":{"row":77,"column":19},"end":{"row":77,"column":21},"action":"insert","lines":["[]"],"id":804}],[{"start":{"row":53,"column":13},"end":{"row":53,"column":14},"action":"insert","lines":[","],"id":805}],[{"start":{"row":53,"column":14},"end":{"row":53,"column":15},"action":"insert","lines":[" "],"id":806}],[{"start":{"row":53,"column":15},"end":{"row":53,"column":16},"action":"insert","lines":["p"],"id":807}],[{"start":{"row":53,"column":16},"end":{"row":53,"column":17},"action":"insert","lines":["c"],"id":808}],[{"start":{"row":53,"column":17},"end":{"row":53,"column":18},"action":"insert","lines":["o"],"id":809}],[{"start":{"row":53,"column":18},"end":{"row":53,"column":19},"action":"insert","lines":["u"],"id":810}],[{"start":{"row":53,"column":19},"end":{"row":53,"column":20},"action":"insert","lines":["n"],"id":811}],[{"start":{"row":53,"column":20},"end":{"row":53,"column":21},"action":"insert","lines":["t"],"id":812}],[{"start":{"row":65,"column":40},"end":{"row":66,"column":0},"action":"insert","lines":["",""],"id":813},{"start":{"row":66,"column":0},"end":{"row":66,"column":11},"action":"insert","lines":["           "]}],[{"start":{"row":66,"column":11},"end":{"row":66,"column":12},"action":"insert","lines":["p"],"id":814}],[{"start":{"row":66,"column":12},"end":{"row":66,"column":13},"action":"insert","lines":["c"],"id":815}],[{"start":{"row":66,"column":13},"end":{"row":66,"column":14},"action":"insert","lines":["o"],"id":816}],[{"start":{"row":66,"column":11},"end":{"row":66,"column":14},"action":"remove","lines":["pco"],"id":817},{"start":{"row":66,"column":11},"end":{"row":66,"column":17},"action":"insert","lines":["pcount"]}],[{"start":{"row":66,"column":17},"end":{"row":66,"column":18},"action":"insert","lines":[" "],"id":818}],[{"start":{"row":66,"column":18},"end":{"row":66,"column":19},"action":"insert","lines":["="],"id":819}],[{"start":{"row":66,"column":19},"end":{"row":66,"column":20},"action":"insert","lines":[" "],"id":820}],[{"start":{"row":66,"column":20},"end":{"row":66,"column":21},"action":"insert","lines":["0"],"id":821}],[{"start":{"row":66,"column":21},"end":{"row":66,"column":22},"action":"insert","lines":[";"],"id":822}],[{"start":{"row":78,"column":20},"end":{"row":78,"column":21},"action":"insert","lines":["p"],"id":823}],[{"start":{"row":78,"column":21},"end":{"row":78,"column":22},"action":"insert","lines":["c"],"id":824}],[{"start":{"row":78,"column":20},"end":{"row":78,"column":22},"action":"remove","lines":["pc"],"id":825},{"start":{"row":78,"column":20},"end":{"row":78,"column":26},"action":"insert","lines":["pcount"]}],[{"start":{"row":78,"column":26},"end":{"row":78,"column":27},"action":"insert","lines":["+"],"id":826}],[{"start":{"row":78,"column":27},"end":{"row":78,"column":28},"action":"insert","lines":["+"],"id":827}],[{"start":{"row":78,"column":28},"end":{"row":78,"column":29},"action":"insert","lines":["+"],"id":828}],[{"start":{"row":78,"column":28},"end":{"row":78,"column":29},"action":"remove","lines":["+"],"id":829}],[{"start":{"row":78,"column":29},"end":{"row":78,"column":30},"action":"insert","lines":[" "],"id":830}],[{"start":{"row":78,"column":30},"end":{"row":78,"column":31},"action":"insert","lines":["="],"id":831}],[{"start":{"row":78,"column":31},"end":{"row":78,"column":32},"action":"insert","lines":[" "],"id":832}],[{"start":{"row":78,"column":32},"end":{"row":78,"column":33},"action":"insert","lines":["p"],"id":833}],[{"start":{"row":78,"column":33},"end":{"row":78,"column":34},"action":"insert","lines":["o"],"id":834}],[{"start":{"row":78,"column":32},"end":{"row":78,"column":34},"action":"remove","lines":["po"],"id":835},{"start":{"row":78,"column":32},"end":{"row":78,"column":38},"action":"insert","lines":["policy"]}],[{"start":{"row":78,"column":38},"end":{"row":78,"column":39},"action":"insert","lines":[";"],"id":836}],[{"start":{"row":39,"column":27},"end":{"row":40,"column":24},"action":"remove","lines":["","    #include \"Globals.h\""],"id":846}],[{"start":{"row":55,"column":42},"end":{"row":61,"column":8},"action":"remove","lines":["{","           for(int i = 0; i < psize; i++){","               if(policies[i] == policy)","                   return true;","           }","           return false;","       }"],"id":847},{"start":{"row":55,"column":42},"end":{"row":55,"column":43},"action":"insert","lines":[";"]}],[{"start":{"row":56,"column":27},"end":{"row":60,"column":8},"action":"remove","lines":["{","           psize = gSvm.appmanager.controller.getPermissionSize();","           policies = new string[psize];","           pcount = 0;","       }"],"id":848},{"start":{"row":56,"column":27},"end":{"row":56,"column":28},"action":"insert","lines":[";"]}],[{"start":{"row":57,"column":38},"end":{"row":68,"column":8},"action":"remove","lines":["{","           Permission newPolicy;","           newPolicy.setPermission(policy);","           ","           if(!gSvm.appmanager.hasPermission(newPolicy)){","              stringstream ss;","              ss << \"Application requires permission \" << policy << \". Have you declared this in your Dev script?\";","              Exception(ss.str(), \"SecurityException\");","           }","           ","           policies[pcount++] = policy;","       }"],"id":849},{"start":{"row":57,"column":38},"end":{"row":57,"column":39},"action":"insert","lines":[";"]}],[{"start":{"row":50,"column":0},"end":{"row":50,"column":1},"action":"insert","lines":["e"],"id":850}],[{"start":{"row":50,"column":1},"end":{"row":50,"column":2},"action":"insert","lines":["x"],"id":851}],[{"start":{"row":50,"column":2},"end":{"row":50,"column":3},"action":"insert","lines":["t"],"id":852}],[{"start":{"row":50,"column":3},"end":{"row":50,"column":4},"action":"insert","lines":["e"],"id":853}],[{"start":{"row":50,"column":4},"end":{"row":50,"column":5},"action":"insert","lines":["r"],"id":854}],[{"start":{"row":50,"column":5},"end":{"row":50,"column":6},"action":"insert","lines":["n"],"id":855}],[{"start":{"row":50,"column":6},"end":{"row":50,"column":7},"action":"insert","lines":[" "],"id":856}],[{"start":{"row":50,"column":0},"end":{"row":50,"column":6},"action":"remove","lines":["extern"],"id":857}],[{"start":{"row":50,"column":0},"end":{"row":50,"column":1},"action":"remove","lines":[" "],"id":858}],[{"start":{"row":38,"column":0},"end":{"row":43,"column":22},"action":"remove","lines":["","    #include \"permission.h\"","    #include \"../logservice/alog.h\"","    #include <stdio.h>","    #include <iostream>","    #include <sstream>"],"id":859}]]},"ace":{"folds":[],"scrolltop":487.77779069947644,"scrollleft":0,"selection":{"start":{"row":9,"column":70},"end":{"row":9,"column":70},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1442962900000,"hash":"b96dbc46970e18df1979f6aa4481513777dfdfd8"}